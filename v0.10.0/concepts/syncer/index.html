<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.104.3"><meta name=robots content="index, follow"><link rel="shortcut icon" href=/kcp/favicons/favicon.ico><link rel=apple-touch-icon href=/kcp/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/kcp/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/kcp/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/kcp/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/kcp/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/kcp/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/kcp/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/kcp/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/kcp/favicons/android-192x192.png sizes=192x192><title>Registering Kubernetes Clusters using syncer | kcp - a multi-tenant control plane for Kubernetes APIs</title><meta name=description content="How to register Kubernetes clusters using syncer
"><meta property="og:title" content="Registering Kubernetes Clusters using syncer"><meta property="og:description" content="How to register Kubernetes clusters using syncer
"><meta property="og:type" content="article"><meta property="og:url" content="http://kcp-dev.github.io/kcp/v0.10.0/concepts/syncer/"><meta property="article:section" content="v0.10.0"><meta property="og:site_name" content="kcp - a multi-tenant control plane for Kubernetes APIs"><meta itemprop=name content="Registering Kubernetes Clusters using syncer"><meta itemprop=description content="How to register Kubernetes clusters using syncer
"><meta itemprop=wordCount content="1296"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Registering Kubernetes Clusters using syncer"><meta name=twitter:description content="How to register Kubernetes clusters using syncer
"><link rel=preload href=/kcp/scss/main.min.880f3e686065cfc264f99718116b68f6dfda007cc1822be21ff6d89ad5db883b.css as=style><link href=/kcp/scss/main.min.880f3e686065cfc264f99718116b68f6dfda007cc1822be21ff6d89ad5db883b.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-00000000-0","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body class=td-page><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-sm-row td-navbar"><a class="navbar-brand mr-2" style=display:flex;justify-content:center href=https://kcp.io><img class=navbar-logo src=/kcp/logo.png width=38px alt=logo></a>
<a class=navbar-brand style=display:flex;justify-content:center href=https://kcp.io><span class="font-weight-bold d-none d-sm-inline d-lg-none" style=font-size:.875rem>kcp</span>
<span class="font-weight-bold d-none d-lg-inline">kcp</span></a><div class="td-navbar-nav-scroll ml-sm-auto mt-0" id=main_navbar><ul class="navbar-nav mt-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=https://docs.kcp.io/kcp/main><span>Documentation</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=https://kcp.io/blog><span>Blog</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=https://github.com/kcp-dev/kcp/blob/main/CONTRIBUTING.md><span>Contribute</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=https://github.com/kcp-dev/kcp/><span>GitHub</span></a></li><li class="nav-item dropdown mr-4 d-none d-lg-block"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Releases</a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=https://kcp-dev.github.io/kcp/main>main</a>
<a class=dropdown-item href=https://kcp-dev.github.io/kcp/v0.10.0>v0.10.0</a></div></li></ul></div><div class="navbar-nav d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><div id=content-mobile><form class="td-sidebar__search d-flex align-items-center"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off>
<button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-section-nav aria-expanded=false aria-label="Toggle section navigation"></button></form></div><div id=content-desktop></div><nav class="collapse td-sidebar-nav foldable-nav" id=td-section-nav><ul class="td-sidebar-nav__section pr-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-kcpv0100-li><a href=/kcp/v0.10.0/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-kcpv0100><span>kcp Documentation</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-kcpv0100concepts-li><input type=checkbox id=m-kcpv0100concepts-check checked>
<label for=m-kcpv0100concepts-check><a href=/kcp/v0.10.0/concepts/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-kcpv0100concepts><span>kcp Concepts</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100conceptsauthorization-li><input type=checkbox id=m-kcpv0100conceptsauthorization-check>
<label for=m-kcpv0100conceptsauthorization-check><a href=/kcp/v0.10.0/concepts/authorization/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100conceptsauthorization><span>Authorization</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100conceptscache-server-li><input type=checkbox id=m-kcpv0100conceptscache-server-check>
<label for=m-kcpv0100conceptscache-server-check><a href=/kcp/v0.10.0/concepts/cache-server/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100conceptscache-server><span>Cache Server</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100conceptscluster-mapper-li><input type=checkbox id=m-kcpv0100conceptscluster-mapper-check>
<label for=m-kcpv0100conceptscluster-mapper-check><a href=/kcp/v0.10.0/concepts/cluster-mapper/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100conceptscluster-mapper><span>Cluster Mapper</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100conceptskubectl-kcp-plugin-li><input type=checkbox id=m-kcpv0100conceptskubectl-kcp-plugin-check>
<label for=m-kcpv0100conceptskubectl-kcp-plugin-check><a href=/kcp/v0.10.0/concepts/kubectl-kcp-plugin/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100conceptskubectl-kcp-plugin><span>Kubectl kcp plugin</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100conceptslocations-and-scheduling-li><input type=checkbox id=m-kcpv0100conceptslocations-and-scheduling-check>
<label for=m-kcpv0100conceptslocations-and-scheduling-check><a href=/kcp/v0.10.0/concepts/locations-and-scheduling/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100conceptslocations-and-scheduling><span>Placement, Locations and Scheduling</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-kcpv0100conceptssyncer-li><input type=checkbox id=m-kcpv0100conceptssyncer-check checked>
<label for=m-kcpv0100conceptssyncer-check><a href=/kcp/v0.10.0/concepts/syncer/ title="Registering Kubernetes Clusters using syncer" class="align-left pl-0 active td-sidebar-link td-sidebar-link__page" id=m-kcpv0100conceptssyncer><span class=td-sidebar-nav-active-item>Syncer</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100conceptsquickstart-tenancy-and-apis-li><input type=checkbox id=m-kcpv0100conceptsquickstart-tenancy-and-apis-check>
<label for=m-kcpv0100conceptsquickstart-tenancy-and-apis-check><a href=/kcp/v0.10.0/concepts/quickstart-tenancy-and-apis/ title="Quickstart: Tenancy and APIs" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100conceptsquickstart-tenancy-and-apis><span>Tenancy and APIs</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100conceptsconcepts-li><input type=checkbox id=m-kcpv0100conceptsconcepts-check>
<label for=m-kcpv0100conceptsconcepts-check><a href=/kcp/v0.10.0/concepts/concepts/ title="Terminology for kcp" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100conceptsconcepts><span>Terminology</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100conceptsvirtual-workspaces-li><input type=checkbox id=m-kcpv0100conceptsvirtual-workspaces-check>
<label for=m-kcpv0100conceptsvirtual-workspaces-check><a href=/kcp/v0.10.0/concepts/virtual-workspaces/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100conceptsvirtual-workspaces><span>Virtual Workspaces</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100conceptsworkspaces-li><input type=checkbox id=m-kcpv0100conceptsworkspaces-check>
<label for=m-kcpv0100conceptsworkspaces-check><a href=/kcp/v0.10.0/concepts/workspaces/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100conceptsworkspaces><span>Workspaces</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-kcpv0100conceptsdevelopers-li><input type=checkbox id=m-kcpv0100conceptsdevelopers-check>
<label for=m-kcpv0100conceptsdevelopers-check><a href=/kcp/v0.10.0/concepts/developers/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-kcpv0100conceptsdevelopers><span>Developers</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100conceptsdeveloperscontrollers-li><input type=checkbox id=m-kcpv0100conceptsdeveloperscontrollers-check>
<label for=m-kcpv0100conceptsdeveloperscontrollers-check><a href=/kcp/v0.10.0/concepts/developers/controllers/ title="Writing kcp-aware controllers" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100conceptsdeveloperscontrollers><span>kcp-aware controllers</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100conceptsdeveloperslibrary-usage-li><input type=checkbox id=m-kcpv0100conceptsdeveloperslibrary-usage-check>
<label for=m-kcpv0100conceptsdeveloperslibrary-usage-check><a href=/kcp/v0.10.0/concepts/developers/library-usage/ title="Using kcp as a library" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100conceptsdeveloperslibrary-usage><span>Library Usage</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100conceptsdevelopersreleasing-li><input type=checkbox id=m-kcpv0100conceptsdevelopersreleasing-check>
<label for=m-kcpv0100conceptsdevelopersreleasing-check><a href=/kcp/v0.10.0/concepts/developers/releasing/ title="Publishing a new kcp release" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100conceptsdevelopersreleasing><span>Publishing</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-kcpv0100conceptsinvestigations-li><input type=checkbox id=m-kcpv0100conceptsinvestigations-check>
<label for=m-kcpv0100conceptsinvestigations-check><a href=/kcp/v0.10.0/concepts/investigations/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-kcpv0100conceptsinvestigations><span>Investigations</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100conceptsinvestigationslogical-clusters-li><input type=checkbox id=m-kcpv0100conceptsinvestigationslogical-clusters-check>
<label for=m-kcpv0100conceptsinvestigationslogical-clusters-check><a href=/kcp/v0.10.0/concepts/investigations/logical-clusters/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100conceptsinvestigationslogical-clusters><span>Logical clusters</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100conceptsinvestigationsminimal-api-server-li><input type=checkbox id=m-kcpv0100conceptsinvestigationsminimal-api-server-check>
<label for=m-kcpv0100conceptsinvestigationsminimal-api-server-check><a href=/kcp/v0.10.0/concepts/investigations/minimal-api-server/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100conceptsinvestigationsminimal-api-server><span>Minimal API Server</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100conceptsinvestigationsself-service-policy-li><input type=checkbox id=m-kcpv0100conceptsinvestigationsself-service-policy-check>
<label for=m-kcpv0100conceptsinvestigationsself-service-policy-check><a href=/kcp/v0.10.0/concepts/investigations/self-service-policy/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100conceptsinvestigationsself-service-policy><span>Self-service policy</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100conceptsinvestigationstransparent-multi-cluster-li><input type=checkbox id=m-kcpv0100conceptsinvestigationstransparent-multi-cluster-check>
<label for=m-kcpv0100conceptsinvestigationstransparent-multi-cluster-check><a href=/kcp/v0.10.0/concepts/investigations/transparent-multi-cluster/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100conceptsinvestigationstransparent-multi-cluster><span>Transparent multi-cluster</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100conceptsstorage-li><input type=checkbox id=m-kcpv0100conceptsstorage-check>
<label for=m-kcpv0100conceptsstorage-check><a href=/kcp/v0.10.0/concepts/storage/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100conceptsstorage><span></span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-kcpv0100cli-li><input type=checkbox id=m-kcpv0100cli-check>
<label for=m-kcpv0100cli-check><a href=/kcp/v0.10.0/cli/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-kcpv0100cli><span>CLI Reference</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100clikcp-li><input type=checkbox id=m-kcpv0100clikcp-check>
<label for=m-kcpv0100clikcp-check><a href=/kcp/v0.10.0/cli/kcp/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100clikcp><span>kcp</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100clikcp_bind-li><input type=checkbox id=m-kcpv0100clikcp_bind-check>
<label for=m-kcpv0100clikcp_bind-check><a href=/kcp/v0.10.0/cli/kcp_bind/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100clikcp_bind><span>kcp bind</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100clikcp_bind_apiexport-li><input type=checkbox id=m-kcpv0100clikcp_bind_apiexport-check>
<label for=m-kcpv0100clikcp_bind_apiexport-check><a href=/kcp/v0.10.0/cli/kcp_bind_apiexport/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100clikcp_bind_apiexport><span>kcp bind apiexport</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100clikcp_bind_compute-li><input type=checkbox id=m-kcpv0100clikcp_bind_compute-check>
<label for=m-kcpv0100clikcp_bind_compute-check><a href=/kcp/v0.10.0/cli/kcp_bind_compute/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100clikcp_bind_compute><span>kcp bind compute</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100clikcp_claims-li><input type=checkbox id=m-kcpv0100clikcp_claims-check>
<label for=m-kcpv0100clikcp_claims-check><a href=/kcp/v0.10.0/cli/kcp_claims/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100clikcp_claims><span>kcp claims</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100clikcp_claims_get-li><input type=checkbox id=m-kcpv0100clikcp_claims_get-check>
<label for=m-kcpv0100clikcp_claims_get-check><a href=/kcp/v0.10.0/cli/kcp_claims_get/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100clikcp_claims_get><span>kcp claims get</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100clikcp_claims_get_apibinding-li><input type=checkbox id=m-kcpv0100clikcp_claims_get_apibinding-check>
<label for=m-kcpv0100clikcp_claims_get_apibinding-check><a href=/kcp/v0.10.0/cli/kcp_claims_get_apibinding/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100clikcp_claims_get_apibinding><span>kcp claims get apibinding</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100clikcp_crd-li><input type=checkbox id=m-kcpv0100clikcp_crd-check>
<label for=m-kcpv0100clikcp_crd-check><a href=/kcp/v0.10.0/cli/kcp_crd/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100clikcp_crd><span>kcp crd</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100clikcp_crd_snapshot-li><input type=checkbox id=m-kcpv0100clikcp_crd_snapshot-check>
<label for=m-kcpv0100clikcp_crd_snapshot-check><a href=/kcp/v0.10.0/cli/kcp_crd_snapshot/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100clikcp_crd_snapshot><span>kcp crd snapshot</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100clikcp_workload-li><input type=checkbox id=m-kcpv0100clikcp_workload-check>
<label for=m-kcpv0100clikcp_workload-check><a href=/kcp/v0.10.0/cli/kcp_workload/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100clikcp_workload><span>kcp workload</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100clikcp_workload_cordon-li><input type=checkbox id=m-kcpv0100clikcp_workload_cordon-check>
<label for=m-kcpv0100clikcp_workload_cordon-check><a href=/kcp/v0.10.0/cli/kcp_workload_cordon/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100clikcp_workload_cordon><span>kcp workload cordon</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100clikcp_workload_drain-li><input type=checkbox id=m-kcpv0100clikcp_workload_drain-check>
<label for=m-kcpv0100clikcp_workload_drain-check><a href=/kcp/v0.10.0/cli/kcp_workload_drain/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100clikcp_workload_drain><span>kcp workload drain</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100clikcp_workload_sync-li><input type=checkbox id=m-kcpv0100clikcp_workload_sync-check>
<label for=m-kcpv0100clikcp_workload_sync-check><a href=/kcp/v0.10.0/cli/kcp_workload_sync/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100clikcp_workload_sync><span>kcp workload sync</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100clikcp_workload_uncordon-li><input type=checkbox id=m-kcpv0100clikcp_workload_uncordon-check>
<label for=m-kcpv0100clikcp_workload_uncordon-check><a href=/kcp/v0.10.0/cli/kcp_workload_uncordon/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100clikcp_workload_uncordon><span>kcp workload uncordon</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100clikcp_workspace-li><input type=checkbox id=m-kcpv0100clikcp_workspace-check>
<label for=m-kcpv0100clikcp_workspace-check><a href=/kcp/v0.10.0/cli/kcp_workspace/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100clikcp_workspace><span>kcp workspace</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100clikcp_workspace_create-li><input type=checkbox id=m-kcpv0100clikcp_workspace_create-check>
<label for=m-kcpv0100clikcp_workspace_create-check><a href=/kcp/v0.10.0/cli/kcp_workspace_create/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100clikcp_workspace_create><span>kcp workspace create</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100clikcp_workspace_create-context-li><input type=checkbox id=m-kcpv0100clikcp_workspace_create-context-check>
<label for=m-kcpv0100clikcp_workspace_create-context-check><a href=/kcp/v0.10.0/cli/kcp_workspace_create-context/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100clikcp_workspace_create-context><span>kcp workspace create-context</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100clikcp_workspace_current-li><input type=checkbox id=m-kcpv0100clikcp_workspace_current-check>
<label for=m-kcpv0100clikcp_workspace_current-check><a href=/kcp/v0.10.0/cli/kcp_workspace_current/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100clikcp_workspace_current><span>kcp workspace current</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100clikcp_workspace_tree-li><input type=checkbox id=m-kcpv0100clikcp_workspace_tree-check>
<label for=m-kcpv0100clikcp_workspace_tree-check><a href=/kcp/v0.10.0/cli/kcp_workspace_tree/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100clikcp_workspace_tree><span>kcp workspace tree</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100clikcp_workspace_use-li><input type=checkbox id=m-kcpv0100clikcp_workspace_use-check>
<label for=m-kcpv0100clikcp_workspace_use-check><a href=/kcp/v0.10.0/cli/kcp_workspace_use/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100clikcp_workspace_use><span>kcp workspace use</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-kcpv0100crd-reference-li><input type=checkbox id=m-kcpv0100crd-reference-check>
<label for=m-kcpv0100crd-reference-check><a href=/kcp/v0.10.0/crd-reference/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-kcpv0100crd-reference><span>CRD Reference</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100crd-referenceapibindingsapiskcpio-li><input type=checkbox id=m-kcpv0100crd-referenceapibindingsapiskcpio-check>
<label for=m-kcpv0100crd-referenceapibindingsapiskcpio-check><a href=/kcp/v0.10.0/crd-reference/apibindings.apis.kcp.io/ title="APIBinding CRD schema reference (group apis.kcp.io)" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100crd-referenceapibindingsapiskcpio><span>APIBinding</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100crd-referenceapiexportsapiskcpio-li><input type=checkbox id=m-kcpv0100crd-referenceapiexportsapiskcpio-check>
<label for=m-kcpv0100crd-referenceapiexportsapiskcpio-check><a href=/kcp/v0.10.0/crd-reference/apiexports.apis.kcp.io/ title="APIExport CRD schema reference (group apis.kcp.io)" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100crd-referenceapiexportsapiskcpio><span>APIExport</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100crd-referenceapiexportendpointslicesapiskcpio-li><input type=checkbox id=m-kcpv0100crd-referenceapiexportendpointslicesapiskcpio-check>
<label for=m-kcpv0100crd-referenceapiexportendpointslicesapiskcpio-check><a href=/kcp/v0.10.0/crd-reference/apiexportendpointslices.apis.kcp.io/ title="APIExportEndpointSlice CRD schema reference (group apis.kcp.io)" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100crd-referenceapiexportendpointslicesapiskcpio><span>APIExportEndpointSlice</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100crd-referenceapiresourceimportsapiresourcekcpio-li><input type=checkbox id=m-kcpv0100crd-referenceapiresourceimportsapiresourcekcpio-check>
<label for=m-kcpv0100crd-referenceapiresourceimportsapiresourcekcpio-check><a href=/kcp/v0.10.0/crd-reference/apiresourceimports.apiresource.kcp.io/ title="APIResourceImport CRD schema reference (group apiresource.kcp.io)" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100crd-referenceapiresourceimportsapiresourcekcpio><span>APIResourceImport</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100crd-referenceapiresourceschemasapiskcpio-li><input type=checkbox id=m-kcpv0100crd-referenceapiresourceschemasapiskcpio-check>
<label for=m-kcpv0100crd-referenceapiresourceschemasapiskcpio-check><a href=/kcp/v0.10.0/crd-reference/apiresourceschemas.apis.kcp.io/ title="APIResourceSchema CRD schema reference (group apis.kcp.io)" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100crd-referenceapiresourceschemasapiskcpio><span>APIResourceSchema</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100crd-referencelocationsschedulingkcpio-li><input type=checkbox id=m-kcpv0100crd-referencelocationsschedulingkcpio-check>
<label for=m-kcpv0100crd-referencelocationsschedulingkcpio-check><a href=/kcp/v0.10.0/crd-reference/locations.scheduling.kcp.io/ title="Location CRD schema reference (group scheduling.kcp.io)" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100crd-referencelocationsschedulingkcpio><span>Location</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100crd-referencelogicalclusterscorekcpio-li><input type=checkbox id=m-kcpv0100crd-referencelogicalclusterscorekcpio-check>
<label for=m-kcpv0100crd-referencelogicalclusterscorekcpio-check><a href=/kcp/v0.10.0/crd-reference/logicalclusters.core.kcp.io/ title="LogicalCluster CRD schema reference (group core.kcp.io)" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100crd-referencelogicalclusterscorekcpio><span>LogicalCluster</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100crd-referencenegotiatedapiresourcesapiresourcekcpio-li><input type=checkbox id=m-kcpv0100crd-referencenegotiatedapiresourcesapiresourcekcpio-check>
<label for=m-kcpv0100crd-referencenegotiatedapiresourcesapiresourcekcpio-check><a href=/kcp/v0.10.0/crd-reference/negotiatedapiresources.apiresource.kcp.io/ title="NegotiatedAPIResource CRD schema reference (group apiresource.kcp.io)" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100crd-referencenegotiatedapiresourcesapiresourcekcpio><span>NegotiatedAPIResource</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100crd-referencepartitionstopologykcpio-li><input type=checkbox id=m-kcpv0100crd-referencepartitionstopologykcpio-check>
<label for=m-kcpv0100crd-referencepartitionstopologykcpio-check><a href=/kcp/v0.10.0/crd-reference/partitions.topology.kcp.io/ title="Partition CRD schema reference (group topology.kcp.io)" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100crd-referencepartitionstopologykcpio><span>Partition</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100crd-referencepartitionsetstopologykcpio-li><input type=checkbox id=m-kcpv0100crd-referencepartitionsetstopologykcpio-check>
<label for=m-kcpv0100crd-referencepartitionsetstopologykcpio-check><a href=/kcp/v0.10.0/crd-reference/partitionsets.topology.kcp.io/ title="PartitionSet CRD schema reference (group topology.kcp.io)" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100crd-referencepartitionsetstopologykcpio><span>PartitionSet</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100crd-referenceplacementsschedulingkcpio-li><input type=checkbox id=m-kcpv0100crd-referenceplacementsschedulingkcpio-check>
<label for=m-kcpv0100crd-referenceplacementsschedulingkcpio-check><a href=/kcp/v0.10.0/crd-reference/placements.scheduling.kcp.io/ title="Placement CRD schema reference (group scheduling.kcp.io)" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100crd-referenceplacementsschedulingkcpio><span>Placement</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100crd-referenceshardscorekcpio-li><input type=checkbox id=m-kcpv0100crd-referenceshardscorekcpio-check>
<label for=m-kcpv0100crd-referenceshardscorekcpio-check><a href=/kcp/v0.10.0/crd-reference/shards.core.kcp.io/ title="Shard CRD schema reference (group core.kcp.io)" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100crd-referenceshardscorekcpio><span>Shard</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100crd-referencesynctargetsworkloadkcpio-li><input type=checkbox id=m-kcpv0100crd-referencesynctargetsworkloadkcpio-check>
<label for=m-kcpv0100crd-referencesynctargetsworkloadkcpio-check><a href=/kcp/v0.10.0/crd-reference/synctargets.workload.kcp.io/ title="SyncTarget CRD schema reference (group workload.kcp.io)" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100crd-referencesynctargetsworkloadkcpio><span>SyncTarget</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100crd-referenceworkspacestenancykcpio-li><input type=checkbox id=m-kcpv0100crd-referenceworkspacestenancykcpio-check>
<label for=m-kcpv0100crd-referenceworkspacestenancykcpio-check><a href=/kcp/v0.10.0/crd-reference/workspaces.tenancy.kcp.io/ title="Workspace CRD schema reference (group tenancy.kcp.io)" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100crd-referenceworkspacestenancykcpio><span>Workspace</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcpv0100crd-referenceworkspacetypestenancykcpio-li><input type=checkbox id=m-kcpv0100crd-referenceworkspacetypestenancykcpio-check>
<label for=m-kcpv0100crd-referenceworkspacetypestenancykcpio-check><a href=/kcp/v0.10.0/crd-reference/workspacetypes.tenancy.kcp.io/ title="WorkspaceType CRD schema reference (group tenancy.kcp.io)" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcpv0100crd-referenceworkspacetypestenancykcpio><span>WorkspaceType</span></a></label></li></ul></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ml-2 pb-1 pt-2 mb-0"><a href=https://github.com/kcp-dev/kcp/tree/main/docs/content/en/v0.10.0/concepts/syncer.md class=td-page-meta--view target=_blank rel=noopener><i class="fa fa-file-alt fa-fw"></i> View page source</a>
<a href=https://github.com/kcp-dev/kcp/edit/main/docs/content/en/v0.10.0/concepts/syncer.md class=td-page-meta--edit target=_blank rel=noopener><i class="fa fa-edit fa-fw"></i> Edit this page</a>
<a href="https://github.com/kcp-dev/kcp/new/main/docs/content/en/v0.10.0/concepts/syncer.md?filename=change-me.md&value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" class=td-page-meta--child target=_blank rel=noopener><i class="fa fa-edit fa-fw"></i> Create child page</a>
<a href="https://github.com/kcp-dev/kcp/issues/new?title=Registering%20Kubernetes%20Clusters%20using%20syncer" class=td-page-meta--issue target=_blank rel=noopener><i class="fas fa-tasks fa-fw"></i> Create documentation issue</a>
<a href=https://github.com/kcp-dev/kcp/issues/new class=td-page-meta--project-issue target=_blank rel=noopener><i class="fas fa-tasks fa-fw"></i> Create project issue</a></div><div class=td-toc><nav id=TableOfContents><ul><li><a href=#requirements>Requirements</a></li><li><a href=#instructions>Instructions</a><ul><li><a href=#select-resources-to-sync>Select resources to sync.</a></li><li><a href=#bind-workspaces-to-the-location-workspace>Bind workspaces to the Location Workspace</a></li><li><a href=#running-a-workload>Running a workload</a></li></ul></li><li><a href=#for-syncer-development>For syncer development</a><ul><li><a href=#building-components>Building components</a></li><li><a href=#start-kcp-on-another-terminal>Start kcp on another terminal</a></li><li><a href=#running-in-a-kind-cluster-with-a-local-registry>Running in a kind cluster with a local registry</a></li><li><a href=#running-locally>Running locally</a></li></ul></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><div class="pageinfo pageinfo-primary"><p>Version v0.10.0 of the
documentation is no longer actively maintained. The site that you are
currently viewing is an archived snapshot.
For up-to-date documentation, see the
<a href=https://kcp-dev.github.io/kcp/main target=_blank>latest version</a>.</p></div><nav aria-label=breadcrumb class=td-breadcrumbs><ol class=breadcrumb><li class=breadcrumb-item><a href=http://kcp-dev.github.io/kcp/v0.10.0/>kcp Documentation</a></li><li class=breadcrumb-item><a href=http://kcp-dev.github.io/kcp/v0.10.0/concepts/>kcp Concepts</a></li><li class="breadcrumb-item active" aria-current=page><a href=http://kcp-dev.github.io/kcp/v0.10.0/concepts/syncer/ aria-disabled=true class="btn-link disabled">Syncer</a></li></ol></nav><div class=td-content><h1>Registering Kubernetes Clusters using syncer</h1><div class=lead>How to register Kubernetes clusters using syncer</div><header class=article-meta></header><p>In order to register a Kubernetes clusters with the kcp server,
users have to install a special component named <a href>syncer</a>.</p><h2 id=requirements>Requirements</h2><ul><li>kcp server</li><li><a href=/kcp/v0.10.0/concepts/kubectl-kcp-plugin/>kcp kubectl plugin</a></li><li>kubernetes cluster</li></ul><h2 id=instructions>Instructions</h2><ol><li><p>(Optional) Skip this step, if you already have a physical cluster.
Create a kind cluster to back the sync target:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>$ kind create cluster
</span></span><span style=display:flex><span>Creating cluster <span style=color:#e6db74>&#34;kind&#34;</span> ...
</span></span><span style=display:flex><span>&lt;snip&gt;
</span></span><span style=display:flex><span>Set kubectl context to <span style=color:#e6db74>&#34;kind-kind&#34;</span>
</span></span><span style=display:flex><span>You can now use your cluster with:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kubectl cluster-info --context kind-kind
</span></span></code></pre></div></li></ol><div class="alert alert-primary" role=alert><h4 class=alert-heading>Note</h4>This step sets current context to the new kind cluster. Make sure to use a KCP kubeconfig for the next steps unless told otherwise.</div><ol><li><p>Create an organisation and immediately enter it:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>$ kubectl kcp workspace create my-org --enter
</span></span><span style=display:flex><span>Workspace <span style=color:#e6db74>&#34;my-org&#34;</span> <span style=color:#f92672>(</span>type root:organization<span style=color:#f92672>)</span> created. Waiting <span style=color:#66d9ef>for</span> it to be ready...
</span></span><span style=display:flex><span>Workspace <span style=color:#e6db74>&#34;my-org&#34;</span> <span style=color:#f92672>(</span>type root:organization<span style=color:#f92672>)</span> is ready to use.
</span></span><span style=display:flex><span>Current workspace is <span style=color:#e6db74>&#34;root:my-org&#34;</span> <span style=color:#f92672>(</span>type <span style=color:#e6db74>&#34;root:organization&#34;</span><span style=color:#f92672>)</span>.
</span></span></code></pre></div></li><li><p>Enable the syncer for a p-cluster:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl kcp workload sync &lt;synctarget name&gt; --syncer-image &lt;image name&gt; -o syncer.yaml
</span></span></code></pre></div><p>Where <code>&lt;image name></code> <a href>one of the syncer images</a> for your corresponding KCP release (e.g. <code>ghcr.io/kcp-dev/kcp/syncer:v0.7.5</code>).</p></li><li><p>Apply the manifest to the p-cluster:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>$ KUBECONFIG<span style=color:#f92672>=</span>&lt;pcluster-config&gt; kubectl apply -f syncer.yaml
</span></span><span style=display:flex><span>namespace/kcp-syncer-kind-1owee1ci created
</span></span><span style=display:flex><span>serviceaccount/kcp-syncer-kind-1owee1ci created
</span></span><span style=display:flex><span>secret/kcp-syncer-kind-1owee1ci-token created
</span></span><span style=display:flex><span>clusterrole.rbac.authorization.k8s.io/kcp-syncer-kind-1owee1ci created
</span></span><span style=display:flex><span>clusterrolebinding.rbac.authorization.k8s.io/kcp-syncer-kind-1owee1ci created
</span></span><span style=display:flex><span>secret/kcp-syncer-kind-1owee1ci created
</span></span><span style=display:flex><span>deployment.apps/kcp-syncer-kind-1owee1ci created
</span></span></code></pre></div><p>and it will create a <code>kcp-syncer</code> deployment:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>$ KUBECONFIG<span style=color:#f92672>=</span>&lt;pcluster-config&gt; kubectl -n kcp-syncer-kind-1owee1ci get deployments
</span></span><span style=display:flex><span>NAME     READY   UP-TO-DATE   AVAILABLE   AGE
</span></span><span style=display:flex><span>kcp-syncer   1/1     <span style=color:#ae81ff>1</span>            <span style=color:#ae81ff>1</span>           13m
</span></span></code></pre></div></li><li><p>Wait for the kcp sync target to go ready:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl wait --for<span style=color:#f92672>=</span>condition<span style=color:#f92672>=</span>Ready synctarget/&lt;mycluster&gt;
</span></span></code></pre></div></li></ol><h3 id=select-resources-to-sync>Select resources to sync.</h3><p>Syncer will by default use the <code>kubernetes</code> APIExport in <code>root:compute</code> workspace and sync <code>deployments/services/ingresses</code>
to the physical cluster. The related API schemas of the physical cluster should be comptible with kubernetes 1.24. User can
select to sync other resources in physical clusters or from other APIExports on kcp server.</p><p>To sync resources that the KCP server does not have an APIExport to support yet, run</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl kcp workload sync &lt;mycluster&gt; --syncer-image &lt;image name&gt; --resources foo.bar -o syncer.yaml
</span></span></code></pre></div><p>And apply the generated manifests to the physical cluster. The syncer will then import the API schema of foo.bar
to the workspace of the synctarget, following up with an auto generated kubernetes APIExport/APIBinding in the same workspace.
You can then create foo.bar in this workspace, or create an APIBinding in another workspace to bind this APIExport.</p><p>To sync resource from another existing APIExport in the KCP server, run</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl kcp workload sync &lt;mycluster&gt; --syncer-image &lt;image name&gt; --apiexports another-workspace:another-apiexport -o syncer.yaml
</span></span></code></pre></div><p>Syncer will start syncing the resources in this <code>APIExport</code> as long as the <code>SyncTarget</code> has compatible API schemas.</p><p>To see if a certain resource is supported to be synced by the syncer, you can check the state of the <code>syncedResources</code> in <code>SyncTarget</code>
status.</p><h3 id=bind-workspaces-to-the-location-workspace>Bind workspaces to the Location Workspace</h3><p>After the <code>SyncTarget</code> is ready, switch to any workspace containing some workloads that you want to sync to this <code>SyncTarget</code>, and run</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl kcp bind compute &lt;workspace of synctarget&gt;
</span></span></code></pre></div><p>This command will create a <code>Placement</code> in the workspace. By default, it will also create <code>APIBinding</code>s for global kubernetes <code>APIExport</code> and
kubernetes <code>APIExport</code> in workspace of <code>SyncTarget</code>, if any of these <code>APIExport</code>s are supported by the <code>SyncTarget</code>.</p><p>Alternatively, if you would like to bind other <code>APIExport</code>s which are supported by the <code>SyncerTarget</code>, run:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>kubectl kcp bind compute &lt;workspace of synctarget&gt; --apiexport &lt;apiexport workspace&gt;:&lt;apiexport name&gt;
</span></span></code></pre></div><p>In addition, you can specify the certain location or namespace to create placement. e.g.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>kubectl kcp bind compute &lt;workspace of synctarget&gt; --location-selectors=env=test --namespace-selector=purpose=workload
</span></span></code></pre></div><p>this command will create a <code>Placement</code> selecting a <code>Location</code> with label <code>env=test</code> and bind the selected <code>Location</code> to namespaces with
label <code>purpose=workload</code>. See more details of placement and location <a href=/kcp/v0.10.0/concepts/locations-and-scheduling/>here</a></p><h3 id=running-a-workload>Running a workload</h3><ol><li><p>Create a deployment:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl create deployment kuard --image gcr.io/kuar-demo/kuard-amd64:blue
</span></span></code></pre></div></li></ol><div class="alert alert-primary" role=alert><h4 class=alert-heading>Note</h4>Replace &ldquo;gcr.io/kuar-demo/kuard-amd64:blue&rdquo; with &ldquo;gcr.io/kuar-demo/kuard-arm64:blue&rdquo; in case you&rsquo;re running
an Apple M1 based virtual machine.</div><ol><li><p>Verify the deployment on the local workspace:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>$ kubectl rollout status deployment/kuard
</span></span><span style=display:flex><span>Waiting <span style=color:#66d9ef>for</span> deployment <span style=color:#e6db74>&#34;kuard&#34;</span> rollout to finish: <span style=color:#ae81ff>0</span> of <span style=color:#ae81ff>1</span> updated replicas are available...
</span></span><span style=display:flex><span>deployment <span style=color:#e6db74>&#34;kuard&#34;</span> successfully rolled out
</span></span></code></pre></div></li></ol><h2 id=for-syncer-development>For syncer development</h2><h3 id=building-components>Building components</h3><p>The syncer, kcp and kubectl plugins should come from the same build, so they are compatible with each other.</p><p>To build, make the root kcp folder your current working directory and run:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>make build-all install build-kind-images
</span></span></code></pre></div><p>If your go version is not 1.19, which is the expected version, you need to run</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>IGNORE_GO_VERSION<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> make build-all install build-kind-images
</span></span></code></pre></div><p>Make a note of the syncer image that is produced by this build, which is in the output near the end. It should be something like <code>kind.local/syncer-c2e3073d5026a8f7f2c47a50c16bdbec:8287441974cf604dd93da5e6d010a78d38ae49733ea3a5031048a516101dd8a2</code>. This will be used by the <code>kubectl kcp workload sync ...</code> command, below.</p><p>The kubectl kcp plugin binaries should be first in your path so kubectl picks them up.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>which kubectl-kcp
</span></span></code></pre></div><p>should point to the kubectl-kcp you have just built in your <code>$GOPATH/bin</code>, and not any other installed version.</p><h3 id=start-kcp-on-another-terminal>Start kcp on another terminal</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kcp start
</span></span></code></pre></div><h3 id=running-in-a-kind-cluster-with-a-local-registry>Running in a kind cluster with a local registry</h3><p>You can run the syncer in a kind cluster for development.</p><ol><li><p>Create a <code>kind</code> cluster with a local registry to simplify syncer development
by executing the following script:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>/bin/bash -c <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>curl -fsSL https://raw.githubusercontent.com/kubernetes-sigs/kind/main/site/static/examples/kind-with-registry.sh<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>
</span></span></code></pre></div></li><li><p>From the kcp root directory:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>export KUBECONFIG<span style=color:#f92672>=</span>.kcp/admin.kubeconfig
</span></span></code></pre></div></li><li><p>Create a location workspace and immediately enter it:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>$ kubectl kcp workspace create my-locations --enter
</span></span><span style=display:flex><span>Workspace <span style=color:#e6db74>&#34;my-locations&#34;</span> <span style=color:#f92672>(</span>type root:organization<span style=color:#f92672>)</span> created. Waiting <span style=color:#66d9ef>for</span> it to be ready...
</span></span><span style=display:flex><span>Workspace <span style=color:#e6db74>&#34;my-locations&#34;</span> <span style=color:#f92672>(</span>type root:organization<span style=color:#f92672>)</span> is ready to use.
</span></span><span style=display:flex><span>Current workspace is <span style=color:#e6db74>&#34;root:my-locations&#34;</span> <span style=color:#f92672>(</span>type <span style=color:#e6db74>&#34;root:organization&#34;</span><span style=color:#f92672>)</span>.
</span></span></code></pre></div></li><li><p>To create the synctarget and use the image pushed to the local registry, supply <code>&lt;image name></code> to the
<code>kcp workload sync</code> plugin command, where <code>&lt;image name></code> was captured in the build steps, above.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl kcp workload sync kind --syncer-image &lt;image name&gt; -o syncer.yaml
</span></span></code></pre></div></li><li><p>Create a second workspace for your workloads and immediately enter it:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>$ kubectl kcp workspace ..
</span></span><span style=display:flex><span>$ kubectl kcp workspace create my-workloads --enter
</span></span><span style=display:flex><span>Workspace <span style=color:#e6db74>&#34;my-workloads&#34;</span> <span style=color:#f92672>(</span>type root:organization<span style=color:#f92672>)</span> created. Waiting <span style=color:#66d9ef>for</span> it to be ready...
</span></span><span style=display:flex><span>Workspace <span style=color:#e6db74>&#34;my-workloads&#34;</span> <span style=color:#f92672>(</span>type root:organization<span style=color:#f92672>)</span> is ready to use.
</span></span><span style=display:flex><span>Current workspace is <span style=color:#e6db74>&#34;root:my-workloads&#34;</span> <span style=color:#f92672>(</span>type <span style=color:#e6db74>&#34;root:organization&#34;</span><span style=color:#f92672>)</span>.
</span></span></code></pre></div></li><li><p>Bind it to the <code>my-locations</code> workspace with the synctarget:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl kcp bind compute <span style=color:#e6db74>&#34;root:my-locations&#34;</span>
</span></span></code></pre></div></li><li><p>Apply the manifest to the p-cluster:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>$ KUBECONFIG<span style=color:#f92672>=</span>&lt;pcluster-config&gt; kubectl apply -f syncer.yaml
</span></span><span style=display:flex><span>namespace/kcp-syncer-kind-1owee1ci created
</span></span><span style=display:flex><span>serviceaccount/kcp-syncer-kind-1owee1ci created
</span></span><span style=display:flex><span>secret/kcp-syncer-kind-1owee1ci-token created
</span></span><span style=display:flex><span>clusterrole.rbac.authorization.k8s.io/kcp-syncer-kind-1owee1ci created
</span></span><span style=display:flex><span>clusterrolebinding.rbac.authorization.k8s.io/kcp-syncer-kind-1owee1ci created
</span></span><span style=display:flex><span>secret/kcp-syncer-kind-1owee1ci created
</span></span><span style=display:flex><span>deployment.apps/kcp-syncer-kind-1owee1ci created
</span></span></code></pre></div><p>and it will create a <code>kcp-syncer</code> deployment:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>$ KUBECONFIG<span style=color:#f92672>=</span>&lt;pcluster-config&gt; kubectl -n kcp-syncer-kind-1owee1ci get deployments
</span></span><span style=display:flex><span>NAME     READY   UP-TO-DATE   AVAILABLE   AGE
</span></span><span style=display:flex><span>kcp-syncer   1/1     <span style=color:#ae81ff>1</span>            <span style=color:#ae81ff>1</span>           13m
</span></span></code></pre></div></li><li><p>Wait for the kcp sync target to go ready:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl wait --for<span style=color:#f92672>=</span>condition<span style=color:#f92672>=</span>Ready synctarget/&lt;mycluster&gt;
</span></span></code></pre></div></li><li><p>Add a deployment to the my-workloads workspace and check the p-cluster to see if the workload has been created there:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl create deployment --image<span style=color:#f92672>=</span>gcr.io/kuar-demo/kuard-amd64:blue --port<span style=color:#f92672>=</span><span style=color:#ae81ff>8080</span> kuard
</span></span></code></pre></div></li></ol><h3 id=running-locally>Running locally</h3><p>TODO(m1kola): we need a less hacky way to run locally: needs to be more close
to what we have when running inside the kind with own kubeconfig.</p><p>This assumes that KCP is also being run locally.</p><ol><li><p>Create a kind cluster to back the sync target:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>$ kind create cluster
</span></span><span style=display:flex><span>Creating cluster <span style=color:#e6db74>&#34;kind&#34;</span> ...
</span></span><span style=display:flex><span>&lt;snip&gt;
</span></span><span style=display:flex><span>Set kubectl context to <span style=color:#e6db74>&#34;kind-kind&#34;</span>
</span></span><span style=display:flex><span>You can now use your cluster with:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kubectl cluster-info --context kind-kind
</span></span></code></pre></div></li><li><p>Make sure to use kubeconfig for your local KCP:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>export KUBECONFIG<span style=color:#f92672>=</span>.kcp/admin.kubeconfig
</span></span></code></pre></div></li><li><p>Create an organisation and immediately enter it:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>$ kubectl kcp workspace create my-org --enter
</span></span><span style=display:flex><span>Workspace <span style=color:#e6db74>&#34;my-org&#34;</span> <span style=color:#f92672>(</span>type root:organization<span style=color:#f92672>)</span> created. Waiting <span style=color:#66d9ef>for</span> it to be ready...
</span></span><span style=display:flex><span>Workspace <span style=color:#e6db74>&#34;my-org&#34;</span> <span style=color:#f92672>(</span>type root:organization<span style=color:#f92672>)</span> is ready to use.
</span></span><span style=display:flex><span>Current workspace is <span style=color:#e6db74>&#34;root:my-org&#34;</span> <span style=color:#f92672>(</span>type <span style=color:#e6db74>&#34;root:organization&#34;</span><span style=color:#f92672>)</span>.
</span></span></code></pre></div></li><li><p>Enable the syncer for a p-cluster:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl kcp workload sync &lt;mycluster&gt; --syncer-image &lt;image name&gt; -o syncer.yaml
</span></span></code></pre></div><p><code>&lt;image name></code> can be anything here as it will only be used to generate <code>syncer.yaml</code> which we are not going to apply.</p></li><li><p>Gather data required for the syncer:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>syncTargetName<span style=color:#f92672>=</span>&lt;mycluster&gt;
</span></span><span style=display:flex><span>syncTargetUID<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>kubectl get synctarget $syncTargetName -o jsonpath<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{.metadata.uid}&#34;</span><span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>fromCluster<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>kubectl ws current --short<span style=color:#66d9ef>)</span>
</span></span></code></pre></div></li><li><p>Run the following snippet:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>go run ./cmd/syncer <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --from-kubeconfig<span style=color:#f92672>=</span>.kcp/admin.kubeconfig <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --from-context<span style=color:#f92672>=</span>base <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --to-kubeconfig<span style=color:#f92672>=</span>$HOME/.kube/config <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --sync-target-name<span style=color:#f92672>=</span>$syncTargetName <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --sync-target-uid<span style=color:#f92672>=</span>$syncTargetUID <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --from-cluster<span style=color:#f92672>=</span>$fromCluster <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --resources<span style=color:#f92672>=</span>configmaps <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --resources<span style=color:#f92672>=</span>deployments.apps <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --resources<span style=color:#f92672>=</span>secrets <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --resources<span style=color:#f92672>=</span>serviceaccounts <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --qps<span style=color:#f92672>=</span><span style=color:#ae81ff>30</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --burst<span style=color:#f92672>=</span><span style=color:#ae81ff>20</span>
</span></span></code></pre></div></li><li><p>Wait for the kcp sync target to go ready:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl wait --for<span style=color:#f92672>=</span>condition<span style=color:#f92672>=</span>Ready synctarget/&lt;mycluster&gt;
</span></span></code></pre></div></li></ol></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="User mailing list" aria-label="User mailing list"><a class=text-white target=_blank rel=noopener href=https://groups.google.com/g/kcp-users aria-label="User mailing list"><i class="fa fa-envelope"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Twitter aria-label=Twitter><a class=text-white target=_blank rel=noopener href=https://twitter.com/kcp aria-label=Twitter><i class="fab fa-twitter"></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel=noopener href=https://github.com/kcp-dev/kcp aria-label=GitHub><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Slack aria-label=Slack><a class=text-white target=_blank rel=noopener href=https://kubernetes.slack.com/archives/C021U8WSAFK aria-label=Slack><i class="fab fa-slack"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Developer mailing list" aria-label="Developer mailing list"><a class=text-white target=_blank rel=noopener href=https://groups.google.com/g/kcp-dev aria-label="Developer mailing list"><i class="fa fa-envelope"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2023 The kcp Authors All Rights Reserved</small></div></div></div></footer></div><script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js integrity="sha512-UR25UO94eTnCVwjbXozyeVd6ZqpaAE9naiEUBK/A+QDbfSTQFhPGj5lOR6d8tsgbBk84Ggb5A3EkjsOgPRPcKA==" crossorigin=anonymous></script>
<script src=/js/tabpane-persist.js></script>
<script src=/kcp/js/main.min.83fbb764ebc08886c2d556187c4546dbef0aee3ae9e883e75f70b983b5db1368.js integrity="sha256-g/u3ZOvAiIbC1VYYfEVG2+8K7jrp6IPnX3C5g7XbE2g=" crossorigin=anonymous></script></body></html>